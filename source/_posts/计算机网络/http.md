---
title: http
date: 2018/3/16 08:28:25
category:
- 计算机网络
tag:
- http
- 计算机网络
comments: true  
---
## 浏览器输入网址发生了什么 ##
1. 首先嘛，你得在浏览器里输入网址
2. 浏览器查找域名的IP地址

    导航的第一步是通过访问的域名找出其IP地址。DNS查找过程如下：

    - 浏览器缓存 – 浏览器会缓存DNS记录一段时间。 不同浏览器会储存个自固定的一个时间（2分钟到30分钟不等）。
      - 系统缓存 – 如果在浏览器缓存里没有找到需要的记录，浏览器会做一个系统调用（windows里是gethostbyname）。这样便可获得系统缓存中的记录。
      - 路由器缓存 – 接着，前面的查询请求发向路由器，它一般会有自己的DNS缓存。
      - ISP DNS 缓存 – 接下来要check的就是ISP缓存DNS的服务器。
      - 递归搜索 – 你的ISP的DNS服务器从跟域名服务器开始进行递归搜索，从.com顶级域名服务器到Facebook的域名服务器。一般DNS服务器的缓存中会有.com域名服务器中的域名，所以到顶级服务器的匹配过程不是那么必要了。

    DNS递归查找如下图所示：
    ![](http://igoro.com/wordpress/wp-content/uploads/2010/02/500pxAn_example_of_theoretical_DNS_recursion_svg.png)

3. 浏览器给web服务器发送一个HTTP请求
4. facebook服务的永久重定向响应
5. 浏览器跟踪重定向地址
6. 服务器“处理”请求
7. 服务器发回一个HTML响应
8. 浏览器开始显示HTML
9. 浏览器发送获取嵌入在HTML中的对象
10. 浏览器发送异步（AJAX）请求

## http1.0 ##
### 过程 ###
1. 客户端打开一个tcp连接
2. 客户端发送请求
3. 服务器发送响应
4. 服务器关闭连接

## http1.1 ##
在第1,4步之间 2,3可以反复发送

请求和响应可以分多个块发送，更好的扩展性

### 基本形式 ###
一个首部行，一个包含元数据的HTTP首部，一个空行，一个消息体

### http请求 ###
![](http://i.imgur.com/MDzDNS8.png)

get请求没有消息体，以一个空行结束

- Accept：浏览器可接受的MIME类型。 
- Accept-Charset：浏览器可接受的字符集。 
- Accept-Encoding：浏览器能够进行解码的数据编码方式，比如gzip。Servlet能够向支持gzip的浏览器返回经gzip编码的HTML页面。许多情形下这可以减少5到10倍的下载时间。 
- Accept-Language：浏览器所希望的语言种类，当服务器能够提供一种以上的语言版本时要用到。 
- Authorization：授权信息，通常出现在对服务器发送的WWW-Authenticate头的应答中。 
- Connection：表示是否需要持久连接。
- Content-Length：表示请求消息正文的长度。post才需要，因为其他的方式正文为0 
- Cookie：这是最重要的请求头信息之一
- From：请求发送者的email地址，由一些特殊的Web客户程序使用，浏览器不会用到它。 
- Host：初始URL中的主机和端口。 
- If-Modified-Since：只有当所请求的内容在指定的日期之后又经过修改才返回它，否则返回304"Not Modified"应答。 
- Pragma：指定"no-cache"值表示服务器必须返回一个刷新后的文档，即使它是代理服务器而且已经有了页面的本地拷贝。 
- Referer：包含一个URL，用户从该URL代表的页面出发访问当前请求的页面。 
- User-Agent：浏览器类型，如果Servlet返回的内容与浏览器类型有关则该值非常有用。 

### http响应 ###
![](http://i.imgur.com/D1HbGQ3.png)

响应的第一行称为状态行。它包含响应所用的 HTTP 版本、状态编码 (200) 和原因短语。示例中包含一个头，其中具有五个字段，接着是一个空行（回车和换行符），然后是响应正文的头两行。

### HTTP码应码 ###
响应码由三位十进制数字组成，它们出现在由HTTP服务器发送的响应的第一行。

响应码分五种类型，由它们的第一位数字表示：

1. 1xx：信息，请求收到，继续处理
2. 2xx：成功，行为被成功地接受、理解和采纳
3. 3xx：重定向，为了完成请求，必须进一步执行的动作
4. 4xx：客户端错误，请求包含语法错误或者请求无法实现
5. 5xx：服务器错误，服务器不能实现一种明显无效的请求

### Keep-Alive ###
http 1.0会为每一个请求打开一个新连接。实际上一个web会话中打开和关闭所有连接花费的时间远大于传输数据的时间。对于使用ssl或tls的加密https这个问题更为严重。

## Http方法 ##
1. get： 本质就是发送一个请求来取得服务器上的某一资源。资源通过一组HTTP头和呈现数据（如HTML文本，或者图片或者视频等）返回给客户端。
2. put: 将资源上传到已知url的服务器
3. delete： 从指定的url删除一个资源
4. post： 将资源上传到已知url的服务器，但是没有指定如何处理这个资源
5. head： 相等于get，不过只返回头部
6. 
  ![](http://i.imgur.com/n40Bpnu.png)

### 请求主体 ###
![](http://i.imgur.com/rX3EaTO.png)

## Coolkie ##
cookie在请求和响应的http首部，从服务器到客户端，再从客户端到服务器。服务器用cookie来指示会话ID，登录凭据等。

![](http://i.imgur.com/9uOOisB.png)

服务器可以设置不止一个cookie。